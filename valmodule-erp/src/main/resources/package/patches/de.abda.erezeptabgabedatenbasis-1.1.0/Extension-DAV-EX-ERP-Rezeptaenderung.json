{
  "resourceType": "StructureDefinition",
  "id": "DAV-EX-ERP-Rezeptaenderung",
  "url": "http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Rezeptaenderung",
  "version": "1.1.0",
  "name": "DAV_EX_ERP_Rezeptaenderung",
  "title": "DAV_EX_ERP_Rezeptaenderung",
  "status": "active",
  "date": "2021-11-05",
  "fhirVersion": "4.0.1",
  "kind": "complex-type",
  "abstract": false,
  "context": [
    {
      "type": "element",
      "expression": "MedicationDispense.substitution"
    }
  ],
  "type": "Extension",
  "baseDefinition": "http://hl7.org/fhir/StructureDefinition/Extension",
  "derivation": "constraint",
  "differential": {
    "element": [
      {
        "id": "Extension",
        "path": "Extension",
        "short": "Angabe einer Rezeptänderung",
        "definition": "Korrekturen bzw. Ergänzungen zu den Verordnungsdaten gemäß Rahmenvertrag nach § 129 SGB V bzw. AMVV.",
        "constraint": [
          {
            "key": "Rezeptaenderung-1",
            "severity": "error",
            "human": "Dokumentation erforderlich bei ArtRezeptaenderung in (2,3,4,12)",
            "expression": "(extension('ArtRezeptaenderung').value as CodeableConcept).coding.code.matches('2|3|4|12') implies extension('DokumentationRezeptaenderung').exists()",
            "source": "http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Rezeptaenderung"
          }
        ]
      },
      {
        "id": "Extension.extension",
        "path": "Extension.extension",
        "slicing": {
          "discriminator": [
            {
              "type": "value",
              "path": "url"
            }
          ],
          "rules": "open"
        },
        "min": 2
      },
      {
        "id": "Extension.extension:ArtRezeptaenderung",
        "path": "Extension.extension",
        "sliceName": "ArtRezeptaenderung",
        "short": "Art der Rezeptänderung",
        "min": 1,
        "max": "1",
        "mustSupport": true
      },
      {
        "id": "Extension.extension:ArtRezeptaenderung.url",
        "path": "Extension.extension.url",
        "fixedUri": "ArtRezeptaenderung"
      },
      {
        "id": "Extension.extension:ArtRezeptaenderung.value[x]",
        "path": "Extension.extension.value[x]",
        "short": "Kennzeichen für die Art der Rezeptänderung",
        "min": 1,
        "type": [
          {
            "code": "CodeableConcept"
          }
        ],
        "mustSupport": true
      },
      {
        "id": "Extension.extension:ArtRezeptaenderung.value[x].coding",
        "path": "Extension.extension.value[x].coding",
        "min": 1,
        "max": "1",
        "mustSupport": true
      },
      {
        "id": "Extension.extension:ArtRezeptaenderung.value[x].coding.system",
        "path": "Extension.extension.value[x].coding.system",
        "min": 1,
        "mustSupport": true
      },
      {
        "id": "Extension.extension:ArtRezeptaenderung.value[x].coding.version",
        "path": "Extension.extension.value[x].coding.version",
        "max": "0"
      },
      {
        "id": "Extension.extension:ArtRezeptaenderung.value[x].coding.code",
        "path": "Extension.extension.value[x].coding.code",
        "min": 1,
        "mustSupport": true
      },
      {
        "id": "Extension.extension:ArtRezeptaenderung.value[x].coding.display",
        "path": "Extension.extension.value[x].coding.display",
        "max": "0"
      },
      {
        "id": "Extension.extension:ArtRezeptaenderung.value[x].coding.userSelected",
        "path": "Extension.extension.value[x].coding.userSelected",
        "max": "0"
      },
      {
        "id": "Extension.extension:ArtRezeptaenderung.value[x].text",
        "path": "Extension.extension.value[x].text",
        "max": "0"
      },
      {
        "id": "Extension.extension:DokumentationRezeptaenderung",
        "path": "Extension.extension",
        "sliceName": "DokumentationRezeptaenderung",
        "short": "Dokumentation der Rezeptänderung",
        "definition": "Die Dokumentation der Rezeptänderung im Freitext ist bei folgenden Arten verpflichtend:\r\n- Code 2 (Korrektur / Ergänzung der Darreichungsform bei Rezepturen),\r\n- Code 3 (Korrektur / Ergänzung der Gebrauchsanweisung bei einer Rezeptur),\r\n- Code 4 (Korrektur / Ergänzung der Dosierungsanweisung),\r\n- Code 12 (Freitextliche Dokumentation der Änderung wenn keiner der anderen Schlüssel / Fälle vorliegt).",
        "min": 0,
        "max": "1",
        "mustSupport": true
      },
      {
        "id": "Extension.extension:DokumentationRezeptaenderung.url",
        "path": "Extension.extension.url",
        "fixedUri": "DokumentationRezeptaenderung"
      },
      {
        "id": "Extension.extension:DokumentationRezeptaenderung.value[x]",
        "path": "Extension.extension.value[x]",
        "short": "Angabe der Rezeptänderung",
        "definition": "Angabe der Rezeptänderung im Freitext, wenn diese bei der ausgewählten Art der Rezeptänderung gefordert wird.",
        "min": 1,
        "type": [
          {
            "code": "string"
          }
        ],
        "maxLength": 1000,
        "mustSupport": true
      },
      {
        "id": "Extension.extension:RueckspracheArzt",
        "path": "Extension.extension",
        "sliceName": "RueckspracheArzt",
        "short": "Angaben zu einer Rücksprache mit dem Arzt",
        "min": 1,
        "max": "1",
        "mustSupport": true
      },
      {
        "id": "Extension.extension:RueckspracheArzt.url",
        "path": "Extension.extension.url",
        "fixedUri": "RueckspracheArzt"
      },
      {
        "id": "Extension.extension:RueckspracheArzt.value[x]",
        "path": "Extension.extension.value[x]",
        "short": "Dokumentation Rücksprache mit dem Arzt",
        "definition": "Kennzeichen, ob eine Rücksprache mit dem Arzt erfolgt ist oder nicht möglich war oder nicht erforderlich war.",
        "min": 1,
        "type": [
          {
            "code": "CodeableConcept"
          }
        ],
        "mustSupport": true,
        "binding": {
          "strength": "required",
          "valueSet": "http://fhir.abda.de/eRezeptAbgabedaten/ValueSet/DAV-VS-ERP-RueckspracheArzt"
        }
      },
      {
        "id": "Extension.extension:RueckspracheArzt.value[x].coding",
        "path": "Extension.extension.value[x].coding",
        "min": 1,
        "max": "1",
        "mustSupport": true
      },
      {
        "id": "Extension.extension:RueckspracheArzt.value[x].coding.system",
        "path": "Extension.extension.value[x].coding.system",
        "min": 1,
        "mustSupport": true
      },
      {
        "id": "Extension.extension:RueckspracheArzt.value[x].coding.version",
        "path": "Extension.extension.value[x].coding.version",
        "max": "0"
      },
      {
        "id": "Extension.extension:RueckspracheArzt.value[x].coding.code",
        "path": "Extension.extension.value[x].coding.code",
        "min": 1,
        "mustSupport": true
      },
      {
        "id": "Extension.extension:RueckspracheArzt.value[x].coding.display",
        "path": "Extension.extension.value[x].coding.display",
        "max": "0"
      },
      {
        "id": "Extension.extension:RueckspracheArzt.value[x].coding.userSelected",
        "path": "Extension.extension.value[x].coding.userSelected",
        "max": "0"
      },
      {
        "id": "Extension.extension:RueckspracheArzt.value[x].text",
        "path": "Extension.extension.value[x].text",
        "max": "0"
      },
      {
        "id": "Extension.extension:DatumRezeptaenderung",
        "path": "Extension.extension",
        "sliceName": "DatumRezeptaenderung",
        "short": "Angabe des Datums der Rezeptänderung",
        "definition": "Das Datum der Rezeptänderung ist anzugeben, wenn es vom Abgabedatum abweicht.",
        "min": 0,
        "max": "1",
        "mustSupport": true
      },
      {
        "id": "Extension.extension:DatumRezeptaenderung.url",
        "path": "Extension.extension.url",
        "fixedUri": "DatumRezeptaenderung"
      },
      {
        "id": "Extension.extension:DatumRezeptaenderung.value[x]",
        "path": "Extension.extension.value[x]",
        "short": "Datum der Rezeptänderung",
        "min": 1,
        "type": [
          {
            "code": "date"
          }
        ],
        "mustSupport": true
      },
      {
        "id": "Extension.url",
        "path": "Extension.url",
        "fixedUri": "http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Rezeptaenderung"
      },
      {
        "id": "Extension.value[x]",
        "path": "Extension.value[x]",
        "max": "0"
      }
    ]
  }
}